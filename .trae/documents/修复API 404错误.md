# 修复API 404错误方案

## 问题分析
访问 `http://175.178.2.155/api/scenes` 返回 404 Not Found 错误，经过分析发现：

1. **Nginx配置正确**：已配置 `location /api/` 反向代理到 `http://127.0.0.1:8000`
2. **FastAPI应用启动失败**：从日志中看到数据库连接错误：
   ```
   sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] 由于目标计算机积极拒绝，无法连接。)")
   ```
3. **无法直接访问FastAPI**：`http://127.0.0.1:8000/api/scenes` 连接失败

## 解决方案

### 1. 修复数据库连接问题

#### 检查MySQL服务状态
- **Windows系统**：
  ```bash
  services.msc  # 打开服务管理器
  # 检查 "MySQL" 或 "MariaDB" 服务是否正在运行
  ```
- **Linux系统**：
  ```bash
  systemctl status mysql  # 或 mariadb
  ```

#### 启动MySQL服务
- **Windows系统**：
  ```bash
  net start mysql  # 或使用服务管理器手动启动
  ```
- **Linux系统**：
  ```bash
  systemctl start mysql  # 或 mariadb
  ```

#### 验证数据库连接
```bash
# 使用MySQL客户端测试连接
mysql -u jokermok -p jokermok00 -h localhost parent_child_literacy
```

### 2. 重启FastAPI应用

#### 停止现有进程
```bash
# Windows系统
taskkill /F /PID <python.exe进程ID>

# Linux系统
kill <python进程ID>
```

#### 重新启动应用
```bash
cd C:\parent_child_literacy_land
python -m uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

### 3. 验证API访问

#### 测试本地访问
```bash
# 使用curl或浏览器访问
curl http://127.0.0.1:8000/api/scenes
```

#### 测试公网访问
```bash
curl http://175.178.2.155/api/scenes
```

### 4. 检查应用日志

查看FastAPI应用的日志，确认是否还有其他错误：
```
# 查看终端输出或日志文件
```

## 预期结果
修复后，访问 `http://175.178.2.155/api/scenes` 将返回正确的场景列表，而不是404错误。

## 可能的其他问题

1. **数据库不存在**：
   - 执行 `database.sql` 文件创建数据库和表：
     ```bash
     mysql -u root -p < database.sql
     ```

2. **数据库用户名或密码错误**：
   - 检查 `app/core/config.py` 中的数据库配置
   - 确保用户名、密码和数据库名正确

3. **端口冲突**：
   - 检查8000端口是否被其他进程占用：
     ```bash
     netstat -ano | findstr :8000  # Windows
     lsof -i :8000  # Linux
     ```
   - 如果被占用，修改FastAPI应用的端口

4. **防火墙问题**：
   - 检查Windows防火墙是否允许8000端口访问
   - 检查云服务器安全组是否开放80和8000端口